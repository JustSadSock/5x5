<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no"/>
  <title>5√ó5 PvP Game</title>
  <link rel="icon" type="image/png" sizes="512x512" href="assets/icon.png"/>
  <link rel="apple-touch-icon" sizes="512x512" href="assets/icon.png"/>
  <link rel="manifest" href="manifest.json"/>
  <meta name="theme-color" content="#000000"/>
  <!-- CROSSLINE_RUNTIME_ENV -->
  <script>
    window.CROSSLINE_API_URL = 'https://visually-definite-frog.ngrok-free.app';
    window.CROSSLINE_WS_URL = 'wss://visually-definite-frog.ngrok-free.app';
  </script>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&family=Manrope:wght@400;700&family=Roboto+Mono:wght@400;700&family=PT+Sans:wght@400;700&family=Fira+Sans:wght@400;700&family=Orbitron:wght@400;700&family=Russo+One&display=swap&subset=cyrillic,latin" rel="stylesheet">
  <script>
    (function() {
      var theme = 'dark';
      try {
        var saved = localStorage.getItem('theme');
        if (saved === 'light' || saved === 'dark') {
          theme = saved;
        }
      } catch (err) {
        /* localStorage might be unavailable, fall back to default */
      }
      document.documentElement.dataset.theme = theme;
    })();
  </script>
  <style>
    * { box-sizing:border-box; margin:0; padding:0; }

    :root {
      color-scheme: dark;
      --color-background: linear-gradient(135deg,#101426,#05060d);
      --color-surface: rgba(30,41,59,0.88);
      --color-surface-alt: rgba(15,23,42,0.92);
      --color-surface-hover: rgba(51,65,85,0.9);
      --color-border: rgba(148,163,184,0.25);
      --color-text-primary: #f8fafc;
      --color-text-muted: #cbd5f5;
      --color-heading: #e2e8f0;
      --color-accent: #38bdf8;
      --color-accent-strong: #0284c7;
      --color-warning: #f97316;
      --color-warning-strong: #ea580c;
      --color-danger: #ef4444;
      --color-danger-strong: #dc2626;
      --color-info: #3b82f6;
      --color-info-strong: #1d4ed8;
      --color-button-text: #ffffff;
      --color-input-bg: rgba(15,23,42,0.7);
      --color-input-border: rgba(148,163,184,0.35);
      --color-overlay: rgba(15,23,42,0.92);
    }

    :root[data-theme="light"] {
      color-scheme: light;
      --color-background: linear-gradient(135deg,#f8fafc,#e2e8f0);
      --color-surface: rgba(255,255,255,0.92);
      --color-surface-alt: rgba(255,255,255,0.88);
      --color-surface-hover: rgba(226,232,240,0.95);
      --color-border: rgba(15,23,42,0.12);
      --color-text-primary: #0f172a;
      --color-text-muted: #475569;
      --color-heading: #0f172a;
      --color-accent: #0ea5e9;
      --color-accent-strong: #0369a1;
      --color-warning: #d97706;
      --color-warning-strong: #b45309;
      --color-danger: #dc2626;
      --color-danger-strong: #b91c1c;
      --color-info: #2563eb;
      --color-info-strong: #1e3a8a;
      --color-button-text: #ffffff;
      --color-input-bg: rgba(248,250,252,0.85);
      --color-input-border: rgba(100,116,139,0.35);
      --color-overlay: rgba(255,255,255,0.92);
    }

    html,body {
      width:100%; height:100%;
      overflow:hidden;
      background:var(--color-background);
      color:var(--color-text-primary);
      touch-action: manipulation;
    }
    body.lang-en { font-family: "Orbitron","Roboto","Manrope",sans-serif; }
    body.lang-ru { font-family: "Russo One","PT Sans","Roboto","Manrope",sans-serif; }
    body.lang-uk { font-family: "Russo One","Fira Sans","Roboto","Manrope",sans-serif; }

    /* –ü–µ—Ä–≤—ã–π —ç–∫—Ä–∞–Ω */
    #modeSelect, #difficultySelect {
      display:flex;
      flex-direction:column;
      justify-content:center;
      align-items:center;
      gap:20px;
      width:100%; height:100vh;
    }
    .panel, .panelDiff {
      width:90%; max-width:360px; padding:20px;
      border-radius:12px;
      box-shadow:0 6px 16px rgba(15,23,42,0.35);
      display:flex; align-items:center; justify-content:center;
      cursor:pointer; font-size:32px;
      color:var(--color-text-primary);
      background:var(--color-surface);
      border:1px solid var(--color-border);
      transition:background .3s ease, transform .3s ease, box-shadow .3s ease;
    }
    .panelDiff {
      border:2px solid transparent;
      box-shadow:0 8px 18px rgba(15,23,42,0.2);
      justify-content:flex-start;
      gap:16px;
      font-size:24px;
      padding:18px 22px;
      min-height:74px;
    }
    .panelDiff .difficulty-icon {
      font-size:26px;
      filter:drop-shadow(0 2px 4px rgba(15,23,42,0.4));
    }
    .panelDiff .difficulty-label {
      font-size:24px;
      font-weight:600;
    }
    .panelDiff.easy {
      background:rgba(34,197,94,0.18);
      border-color:#22c55e;
    }
    .panelDiff.easy:hover { background:rgba(34,197,94,0.26); }
    .panelDiff.medium {
      background:rgba(250,204,21,0.22);
      border-color:#facc15;
    }
    .panelDiff.medium:hover { background:rgba(250,204,21,0.3); }
    .panelDiff.hard {
      background:rgba(239,68,68,0.2);
      border-color:var(--color-danger);
    }
    .panelDiff.hard:hover { background:rgba(239,68,68,0.28); }
    .panelDiff.expert {
      background:rgba(168,85,247,0.22);
      border-color:#a855f7;
    }
    .panelDiff.expert:hover { background:rgba(168,85,247,0.3); }
    .panelDiff.insane {
      background:rgba(148,163,184,0.25);
      border-color:#94a3b8;
    }
    .panelDiff.insane:hover { background:rgba(148,163,184,0.32); }
    .panel:hover { background:var(--color-surface-hover); }
    .panel:hover, .panelDiff:hover {
      transform:translateY(-2px);
      box-shadow:0 12px 24px rgba(15,23,42,0.28);
    }
    .modeBtn {
      background:var(--color-accent);
      color:var(--color-button-text);
    }
    .modeBtn:hover { background:var(--color-accent-strong); }
    .rulesBtn {
      background:var(--color-warning);
      color:var(--color-button-text);
    }
    .rulesBtn:hover { background:var(--color-warning-strong); }
    #btn1p { background:var(--color-info); }
    #btn1p:hover { background:var(--color-info-strong); }
    #btn2p { background:var(--color-danger); }
    #btn2p:hover { background:var(--color-danger-strong); }
    #btnOnline { background:var(--color-accent); }
    #difficultySelect { display:none; }
    .panelDiff.easy { border-color:#22c55e; }
    .panelDiff.medium { border-color:#facc15; }
    .panelDiff.hard { border-color:var(--color-danger); }
    .panelDiff.expert { border-color:#a855f7; }
    .panelDiff.insane { border-color:#94a3b8; }

    #onlineMenu {
      display:none;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      gap:10px;
      margin-top:20px;
      height:100vh;
      padding-bottom:40px;
    }
    #onlineMenu input {
      padding:10px 14px;
      border-radius:10px;
      border:1px solid var(--color-input-border);
      background:var(--color-input-bg);
      color:var(--color-text-primary);
    }
    #onlineMenu input::placeholder { color:var(--color-text-muted); }

    #title {
      font-size:48px;
      font-weight:700;
      color:var(--color-heading);
      text-shadow:none;
      text-align:center;
    }

    #tagline {
      font-size:20px;
      color:var(--color-text-muted);
      margin-bottom:10px;
      text-align:center;
    }

    /* –ü—Ä–∞–≤–∏–ª–∞ */
    #rulesOverlay {
      display:none; position:absolute;
      top:10%; left:10%; width:80%; height:80%;
      background:var(--color-overlay); border:1px solid var(--color-border);
      border-radius:12px; padding:24px; z-index:30;
      overflow:auto;
      box-shadow:0 18px 40px rgba(15,23,42,0.35);
    }
    #rulesOverlay h2, #rulesOverlay h3 { color:var(--color-heading); }
    #rulesOverlay p, #rulesOverlay ul { color:var(--color-text-primary); margin:8px 0; }
    #rulesOverlay ul { padding-left:20px; }
    #rulesClose {
      margin-top:20px;
      background:var(--color-danger);
      color:var(--color-button-text);
      padding:10px 18px;
      border:none; border-radius:8px;
      cursor:pointer;
    }
    #rulesClose:hover { background:var(--color-danger-strong); }
    #rulesTutorial {
      margin-top:20px; margin-right:10px;
      background:var(--color-info);
      color:var(--color-button-text);
      padding:10px 18px;
      border:none; border-radius:8px;
      cursor:pointer;
    }
    #rulesTutorial:hover { background:var(--color-info-strong); }

    /* –ü–æ–ª–µ –∏ UI */
    #gameArea {
      width:100%;
      display:flex;
      flex-direction:column;
      align-items:center;
    }
    #board {
      visibility:hidden;
      display:grid; grid-template:repeat(5,60px)/repeat(5,60px);
      gap:3px; margin:40px auto;
      padding:8px; background:var(--color-surface-alt);
      border:1px solid var(--color-border); border-radius:16px;
      box-shadow:0 16px 32px rgba(15,23,42,0.35);
    }
    .cell {
      width:60px; height:60px;
      background:var(--color-surface);
      border:1px solid var(--color-border);
      position:relative; transition:background .2s, transform .2s;
      box-shadow:inset 0 0 8px rgba(15,23,42,0.22);
    }
    .cell:hover { background:var(--color-surface-hover); }
    .cracked {
      background:
        repeating-linear-gradient(45deg,#222 0 10px,#400 10px 20px),
        linear-gradient(#444,#222);
    }
    .cracked::after {
      content:''; position:absolute; inset:0;
      background:rgba(255,80,0,0.5); mix-blend-mode:screen;
      pointer-events:none;
    }
    .lava { background:radial-gradient(circle,#f60,#a00); }
    .collapse { animation:edgeCollapse 0.6s forwards; }
    @keyframes edgeCollapse {
      0% { transform:translateY(0); opacity:1; }
      50% { transform:translateY(20px); }
      100% { transform:translateY(80px); opacity:0; }
    }

    #ui {
      visibility:hidden; opacity:0; transform:translateY(20px);
      width:100%; max-width:360px;
      margin:10px auto;
      background:var(--color-surface-alt);
      padding:14px; display:flex;
      flex-direction:column; gap:10px;
      border-radius:12px;
      border:1px solid var(--color-border);
      box-shadow:0 12px 28px rgba(15,23,42,0.35);
      transition:opacity .3s ease, transform .3s ease;
    }
    #ui.show { visibility:visible; opacity:1; transform:translateY(0); }
    #phase { text-align:center; color:var(--color-heading); min-height:24px; }
    #planCells { display:flex; justify-content:space-between; margin-bottom:6px; gap:8px; }
    .planCell {
      width:18%; height:32px;
      background:var(--color-surface);
      border:1px solid var(--color-border);
      border-radius:8px;
      display:flex; align-items:center; justify-content:center;
      font-size:18px; color:var(--color-heading);
    }

    #actions {
      display:grid;
      grid-template:repeat(3,1fr)/repeat(2,1fr);
      gap:8px;
      padding:8px;
      background:var(--color-surface);
      border:1px solid var(--color-border);
      border-radius:12px;
      box-shadow:inset 0 0 14px rgba(15,23,42,0.18);
    }
    #actions button,
    #btn-del, #btn-next {
      position:relative;
      padding:12px; font-size:20px; border:none;
      border-radius:10px;
      cursor:pointer;
      box-shadow:0 6px 14px rgba(15,23,42,0.3);
      transition:transform .15s ease, box-shadow .15s ease, background .15s ease;
    }
    #actions button.moveBtn {
      background:var(--color-info);
      color:var(--color-button-text);
    }
    #actions button.moveBtn:hover:not(:disabled) { background:var(--color-info-strong); }
    #actions button.atkBtn  {
      background:var(--color-danger);
      color:var(--color-button-text);
    }
    #actions button.atkBtn:hover:not(:disabled) { background:var(--color-danger-strong); }
    #actions button.shieldBtn {
      background:var(--color-accent);
      color:var(--color-button-text);
    }
    #actions button.shieldBtn:hover:not(:disabled) { background:var(--color-accent-strong); }
    #actions button:hover:not(:disabled),
    #btn-del:hover:not(:disabled), #btn-next:hover:not(:disabled) {
      transform:translateY(-2px);
      box-shadow:0 12px 22px rgba(15,23,42,0.32);
    }
    #actions button:active:not(:disabled),
    #btn-del:active:not(:disabled), #btn-next:active:not(:disabled) {
      transform:scale(0.96);
      box-shadow:0 4px 10px rgba(15,23,42,0.28);
    }
    #actions button:disabled, .blocked,
    #btn-next:disabled {
      background:var(--color-border);
      color:var(--color-text-muted);
      cursor:default;
      box-shadow:none;
    }
    #actions button::after {
      content:'';
      position:absolute; inset:0; border-radius:inherit;
      background:rgba(255,255,255,0.3);
      opacity:0; transform:scale(0);
    }
    #actions button:active::after {
      animation:ripple .3s ease forwards;
    }
    #btn-del {
      background:var(--color-surface);
      color:var(--color-text-primary);
      border:1px solid var(--color-border);
    }
    #btn-del:hover:not(:disabled) { background:var(--color-surface-hover); }
    #btn-next {
      background:var(--color-accent);
      color:var(--color-button-text);
      border:none;
    }
    #btn-next:hover:not(:disabled) { background:var(--color-accent-strong); }

    /* –Æ–Ω–∏—Ç—ã –∏ —ç—Ñ—Ñ–µ–∫—Ç—ã */
    .playerA, .playerB {
      position:absolute; width:40px; height:40px;
      border-radius:50%; top:50%; left:50%;
      transform:translate(-50%,-50%); z-index:5;
      box-shadow:0 0 6px rgba(0,0,0,0.6);
    }
    .moveAnim { animation:moveAnim 0.2s ease; }
    .playerA { background:#0af; }
    .playerB { background:#f40; }
    @keyframes moveAnim {
      from { transform:translate(-50%,-50%) scale(0.8); opacity:0.7; }
      to   { transform:translate(-50%,-50%) scale(1); opacity:1; }
    }
    .playerHalf {
      position:absolute; width:20px; height:40px;
      top:50%; transform:translateY(-50%); z-index:5;
    }
    .halfA {
      background:#0af;
      border-top-left-radius:40px; border-bottom-left-radius:40px;
      left:10px;
    }
    .halfB {
      background:#f40;
      border-top-right-radius:40px; border-bottom-right-radius:40px;
      right:10px;
    }
    .attack {
      position:absolute; width:100%; height:100%;
      background:rgba(255,0,0,0.5);
      animation:atkAnim 0.25s ease forwards; z-index:2;
    }
    .shield {
      position:absolute; width:80%; height:80%;
      background:rgba(0,0,255,0.6); border-radius:50%;
      top:50%; left:50%; transform:translate(-50%,-50%);
      animation:shieldAnim 0.25s ease forwards; z-index:6;
    }
    .death {
      position:absolute; width:100%; height:100%;
      background:rgba(255,255,0,0.8); border-radius:50%;
      animation:deathAnim 0.3s ease forwards; z-index:8;
    }
    @keyframes atkAnim {
      0% { opacity:0; transform:scale(0.5); }
      50% { opacity:0.7; }
      100% { opacity:0; transform:scale(1.2); }
    }
    @keyframes shieldAnim {
      from { transform:translate(-50%,-50%) scale(0); opacity:0.6; }
      to   { transform:translate(-50%,-50%) scale(1); opacity:0.6; }
    }
    @keyframes deathAnim {
      from { transform:scale(0.5); opacity:1; }
      to   { transform:scale(1.5); opacity:0; }
    }
    @keyframes ripple { from{opacity:0.4; transform:scale(0)}
                       to{opacity:0; transform:scale(1)} }

    .planMove, .planAttack, .planShield {
      position:absolute; top:50%; left:50%;
      transform:translate(-50%,-50%);
      z-index:4; opacity:0.9; transition:all .15s ease;
    }
    .planMove   { color:var(--color-heading); font-size:32px; line-height:60px; text-align:center; }
    .planAttack { color:var(--color-danger); font-size:32px; line-height:60px; text-align:center; }
    .planShield { width:60%; height:60%; border:3px solid var(--color-info); border-radius:50%; }

    /* –û–≤–µ—Ä–ª–µ–π –∞—Ç–∞–∫–∏ */
    #atkOverlay {
      visibility:hidden;
      position:absolute; top:50%; left:50%;
      transform:translate(-50%,-50%);
      background:var(--color-overlay); padding:20px;
      display:grid; gap:8px;
      grid-template-columns:repeat(3, 70px);
      grid-template-rows:repeat(3, 70px) auto auto;
      grid-template-areas:
        ". up ."
        "left . right"
        ". down ."
        "confirm confirm confirm"
        "cancel cancel cancel";
      border-radius:14px; z-index:10;
      border:1px solid var(--color-border);
      box-shadow:0 20px 44px rgba(15,23,42,0.35);
    }
    #atkOverlay button {
      background:var(--color-danger);
      color:var(--color-button-text) !important;
      border:none !important;
      font-size:32px;
      width:70px; height:70px;
      border-radius:12px;
      box-shadow:0 6px 14px rgba(15,23,42,0.3);
    }
    #atkOverlay button:hover { background:var(--color-danger-strong); }
    #atkOverlay .up    { grid-area: up; }
    #atkOverlay .down  { grid-area: down; }
    #atkOverlay .left  { grid-area: left; }
    #atkOverlay .right { grid-area: right; }
    #atkOverlay .confirm {
      background:var(--color-accent);
      color:var(--color-button-text) !important;
      border:none !important;
      grid-area: confirm;
      height:40px;
      border-radius:10px;
    }
    #atkOverlay .confirm:hover { background:var(--color-accent-strong); }
    #atkOverlay .cancel {
      background:var(--color-surface);
      color:var(--color-text-primary) !important;
      border:1px solid var(--color-border) !important;
      grid-area: cancel;
      height:40px;
      border-radius:10px;
    }
    #atkOverlay .cancel:hover { background:var(--color-surface-hover); }

    .sel {
      outline:3px solid #ff0;
    }

    /* Overlay for replay mode */
    #replayOverlay {
      display:none; position:absolute; top:0; left:0;
      width:100%; height:100%; background:rgba(0,0,0,0.2);
      pointer-events:none; z-index:30;
    }
    #replayOverlay.show {
      display:block;
      pointer-events:auto;
    }
    #replayOverlay button {
      position:absolute; top:10px; right:10px;
      padding:10px 16px;
      background:var(--color-surface);
      color:var(--color-text-primary) !important;
      border:1px solid var(--color-border) !important;
      border-radius:10px;
      pointer-events:auto;
    }
    #replayOverlay button:hover { background:var(--color-surface-hover); }
    .speedControl {
      display:flex;
      align-items:center;
      gap:8px;
      background:var(--color-surface-alt);
      padding:8px 12px;
      border-radius:12px;
      pointer-events:auto;
      border:1px solid var(--color-border);
      box-shadow:0 10px 24px rgba(15,23,42,0.28);
    }
    .replayControls {
      position:absolute;
      bottom:20px;
      left:50%;
      transform:translateX(-50%);
      width:calc(100% - 40px);
      max-width:360px;
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:8px;
      pointer-events:auto;
    }
    .replayControls input[type=range] {
      width:100%;
    }
    .speedBtn {
      background:var(--color-surface);
      color:var(--color-text-primary);
      border:1px solid var(--color-border);
      border-radius:8px;
      padding:6px 10px;
      cursor:pointer;
      transition:background .2s ease;
    }
    .speedBtn:hover { background:var(--color-surface-hover); }
    #replayPause {
      left:10px;
      right:auto;
      padding:2px 4px;
      width:28px;
      font-size:14px;
    }
    .speedBtn.active {
      background:var(--color-accent);
      color:var(--color-button-text);
      border:none;
    }

    /* Tutorial overlay */
    #tutorialOverlay {
      display:none; position:absolute; top:0; left:0;
      width:100%; height:100%;
      background:var(--color-overlay);
      flex-direction:column;
      justify-content:center; align-items:center;
      text-align:center; padding:24px;
      z-index:40;
      color:var(--color-text-primary);
    }
    #tutorialOverlay.show { display:flex; }
    #tutorialOverlay button {
      margin-top:20px;
      padding:10px 18px;
      background:var(--color-accent);
      color:var(--color-button-text);
      border:none;
      border-radius:10px;
      cursor:pointer;
    }
    #tutorialOverlay button:hover { background:var(--color-accent-strong); }

    /* –û–ø–ø–æ–Ω–µ–Ω—Ç –ø–æ–∫–∏–Ω—É–ª –∏–≥—Ä—É */
    #leaveOverlay,
    #speedModal,
    #resultOverlay {
      position:absolute; top:50%; left:50%;
      transform:translate(-50%,-50%);
      background:var(--color-overlay);
      padding:24px;
      border-radius:16px; text-align:center;
      z-index:30;
      border:1px solid var(--color-border);
      box-shadow:0 18px 40px rgba(15,23,42,0.32);
      color:var(--color-text-primary);
    }
    #leaveOverlay button,
    #speedModal button,
    #resultOverlay button {
      margin-top:10px;
      padding:10px 16px;
      background:var(--color-accent);
      color:var(--color-button-text) !important;
      border:none !important;
      border-radius:10px;
      cursor:pointer;
    }
    #leaveOverlay button:hover,
    #speedModal button:hover,
    #resultOverlay button:hover { background:var(--color-accent-strong); }

    /* –°—á—ë—Ç */
    #scoreboard {
      position:absolute; top:12px; left:50%; transform:translateX(-50%);
      background:var(--color-surface-alt);
      padding:16px 24px;
      border-radius:24px;
      display:flex;
      flex-wrap:wrap;
      align-items:center;
      justify-content:center;
      gap:16px 24px;
      font-family:'Roboto Mono', monospace;
      border:1px solid var(--color-border);
      box-shadow:0 12px 30px rgba(15,23,42,0.3);
      z-index:25;
      min-width:min(100%, 320px);
      max-width:min(90vw, 640px);
    }
    #scoreboard .scoreboard-scores {
      display:flex;
      align-items:center;
      gap:12px;
      font-size:28px;
      font-weight:700;
      letter-spacing:1px;
      color:var(--color-heading);
    }
    #scoreboard .score-divider {
      opacity:0.7;
    }
    #scoreboard .scoreboard-actions,
    #scoreboard .scoreboard-quick {
      display:flex;
      align-items:center;
      gap:12px;
    }
    #scoreboard .scoreboard-actions {
      flex-wrap:wrap;
      justify-content:center;
    }
    #scoreboard button {
      padding:10px 18px;
      background:var(--color-surface);
      color:var(--color-text-primary);
      border:1px solid var(--color-border);
      border-radius:14px;
      cursor:pointer;
      transition:background .2s ease, transform .2s ease;
      font-size:16px;
      min-width:128px;
      font-weight:600;
    }
    #scoreboard .scoreboard-actions button {
      flex:1 1 140px;
    }
    #scoreboard .scoreboard-quick button {
      min-width:0;
      width:44px;
      height:44px;
      padding:0;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:20px;
      border-radius:50%;
    }
    #scoreboard button:hover { background:var(--color-surface-hover); transform:translateY(-1px); }
    #scoreReset {
      background:var(--color-danger);
      color:var(--color-button-text);
    }
    #scoreReset:hover { background:var(--color-danger-strong); }
    #settingsBtn { background:var(--color-surface); }
    #menuBtn {
      background:var(--color-info);
      color:var(--color-button-text);
    }
    #menuBtn:hover { background:var(--color-info-strong); }
    #replayBtn {
      background:var(--color-accent);
      color:var(--color-button-text);
    }
    #replayBtn:hover { background:var(--color-accent-strong); }
    #themeToggle { font-size:18px; }
    #scoreboard #scoreReset,
    #scoreboard #menuBtn,
    #scoreboard #replayBtn {
      border:none;
    }

    #settingsModal {
      display:none; position:absolute; top:50%; left:50%;
      transform:translate(-50%,-50%);
      background:var(--color-overlay);
      padding:24px; border-radius:16px;
      border:1px solid var(--color-border);
      box-shadow:0 20px 44px rgba(15,23,42,0.35);
      z-index:30; color:var(--color-text-primary);
      font-family:'Roboto','Manrope',sans-serif;
      min-width:260px;
    }
    #settingsModal label { display:block; margin-bottom:16px; color:var(--color-text-primary); }
    #settingsModal input[type="range"] {
      width:100%;
      accent-color:var(--color-accent);
    }
    #settingsModal button {
      background:var(--color-accent);
      color:var(--color-button-text);
      border:none;
      padding:10px 18px;
      border-radius:10px;
      cursor:pointer;
    }
    #settingsModal button:hover { background:var(--color-accent-strong); }

    .dropdown { position:relative; display:inline-block; width:100%; }
    .dropdown-display {
      padding:10px 36px 10px 12px;
      background:var(--color-input-bg);
      border:1px solid var(--color-input-border);
      color:var(--color-text-primary);
      border-radius:10px; cursor:pointer;
      position:relative;
    }
    .dropdown-display::after {
      content:'‚ñæ'; position:absolute; right:12px; top:50%;
      transform:translateY(-50%);
      pointer-events:none;
      color:var(--color-text-muted);
      font-size:14px;
    }
    .dropdown.open .dropdown-display::after { transform:translateY(-50%) rotate(180deg); }
    .dropdown-list {
      display:none; position:absolute; top:100%; left:0; min-width:100%;
      background:var(--color-input-bg);
      border:1px solid var(--color-input-border); border-radius:10px; margin-top:6px;
      z-index:40;
      box-shadow:0 12px 24px rgba(15,23,42,0.28);
    }
    .dropdown.open .dropdown-list { display:block; }
    .dropdown-option { padding:10px 12px; cursor:pointer; color:var(--color-text-primary); }
    .dropdown-option:hover { background:var(--color-surface-hover); }

    /* –í—Å–ø–ª—ã–≤–∞—é—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è */
    #confirmToast {
      position:absolute;
      top:40%;
      left:50%;
      transform:translate(-50%,-50%);
      background:var(--color-surface-alt);
      padding:10px 18px;
      border-radius:12px;
      color:var(--color-text-primary);
      z-index:30;
      pointer-events:none;
      opacity:0;
      border:1px solid var(--color-border);
      box-shadow:0 12px 24px rgba(15,23,42,0.28);
      transition:opacity .3s;
    }
    #confirmToast.show { opacity:1; }

    button {
      font-family:inherit;
      background:var(--color-surface);
      color:var(--color-text-primary);
      border:1px solid var(--color-border);
      border-radius:10px;
      cursor:pointer;
      transition:background .2s ease, box-shadow .2s ease, transform .2s ease;
    }
    button:hover:not(:disabled) {
      background:var(--color-surface-hover);
      box-shadow:0 8px 18px rgba(15,23,42,0.25);
      transform:translateY(-1px);
    }
    button:active:not(:disabled) {
      box-shadow:0 4px 10px rgba(15,23,42,0.22);
      transform:translateY(0) scale(0.97);
    }
    button:disabled {
      cursor:default;
      opacity:0.6;
      box-shadow:none;
    }

    /* –ú–µ–ª–∫–∏–µ –ø—Ä–∞–≤–∫–∏ –¥–ª—è —à–∏—Ä–æ–∫–∏—Ö —ç–∫—Ä–∞–Ω–æ–≤ */
    @media (min-width: 600px) {
      #board { margin-top:60px; }
    }

    /* –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø—Ä–∞–≤–∫–∏ –¥–ª—è –ø–æ—Ä—Ç—Ä–µ—Ç–Ω–æ–π –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏ */
    @media (orientation: portrait) {
      #board {
        grid-template: repeat(5,50px)/repeat(5,50px);
        margin-top:20px;
      }
      .cell {
        width:50px;
        height:50px;
      }
      #ui {
        max-width:300px;
        gap:8px;
      }
      #navButtons {
        flex-direction:column;
      }
    }
    @media (max-width: 480px) {
      #board { margin-top:60px; }
    }
  </style>
</head>
<body>


  <div id="modeSelect">
    <h1 id="title">5√ó5 Arena</h1>
    <div id="tagline"></div>
    <div id="btn1p" class="panel modeBtn" data-i18n="singlePlayer" data-sound="nav">1 –∏–≥—Ä–æ–∫</div>
    <div id="rulesBtnInitial" class="panel rulesBtn" data-i18n="rules" data-sound="nav">–ü—Ä–∞–≤–∏–ª–∞</div>
    <div id="btn2p" class="panel modeBtn" data-i18n="twoPlayers" data-sound="nav">2 –∏–≥—Ä–æ–∫–∞</div>
    <div id="btnOnline" class="panel modeBtn" data-i18n="online" data-sound="nav">–û–Ω–ª–∞–π–Ω</div>
  </div>

  <div id="difficultySelect">
    <div class="panelDiff easy" data-sound="nav" data-i18n-title="easyHint" title="–ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ø–µ—Ä–≤—ã—Ö –∏–≥—Ä">
      <span class="difficulty-icon" aria-hidden="true">üå±</span>
      <span class="difficulty-label" data-i18n="easy">–õ–µ–≥–∫–æ</span>
    </div>
    <div class="panelDiff medium" data-sound="nav" data-i18n-title="mediumHint" title="–ë–∞–ª–∞–Ω—Å –∞—Ç–∞–∫–∏ –∏ –∑–∞—â–∏—Ç—ã">
      <span class="difficulty-icon" aria-hidden="true">üõ°Ô∏è</span>
      <span class="difficulty-label" data-i18n="medium">–°—Ä–µ–¥–Ω–µ</span>
    </div>
    <div class="panelDiff hard" data-sound="nav" data-i18n-title="hardHint" title="–ë—ã—Å—Ç—Ä—ã–µ –≤—Ä–∞–≥–∏ –∏ –∞–≥—Ä–µ—Å—Å–∏—è">
      <span class="difficulty-icon" aria-hidden="true">‚öîÔ∏è</span>
      <span class="difficulty-label" data-i18n="hard">–°–ª–æ–∂–Ω–æ</span>
    </div>
    <div class="panelDiff expert" data-sound="nav" data-i18n-title="expertHint" title="–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –±–æ—Ç–∞">
      <span class="difficulty-icon" aria-hidden="true">üí•</span>
      <span class="difficulty-label" data-i18n="expert">–≠–∫—Å–ø–µ—Ä—Ç</span>
    </div>
    <div class="panelDiff insane" data-sound="nav" data-i18n-title="insaneHint" title="–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –≤—ã–∑–æ–≤ –¥–ª—è —á–µ–º–ø–∏–æ–Ω–æ–≤">
      <span class="difficulty-icon" aria-hidden="true">‚ò†Ô∏è</span>
      <span class="difficulty-label" data-i18n="insane">–ë–µ–∑—É–º–∏–µ</span>
    </div>
  </div>

  <div id="onlineMenu">
    <div id="onlineCreate" class="panel modeBtn" data-i18n="createRoom" data-sound="nav">–°–æ–∑–¥–∞—Ç—å –∫–æ–º–Ω–∞—Ç—É</div>
    <input id="roomInput" data-i18n="roomCodePlaceholder" data-i18n-placeholder placeholder="–ö–æ–¥ –∫–æ–º–Ω–∞—Ç—ã" style="padding:6px;max-width:140px;">
    <div id="onlineJoin" class="panel modeBtn" data-i18n="joinRoom" data-sound="nav">–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è</div>
    <div id="roomCode"></div>
    <div id="connectionStatus" style="font-family:'Roboto Mono',monospace;font-size:12px;"></div>
    <div id="log" style="font-family:'Roboto Mono', monospace; font-size: 12px;"></div>
  </div>

  <div id="scoreboard">
    <div class="scoreboard-scores" aria-live="polite">
      <span id="scoreA">0</span>
      <span class="score-divider">:</span>
      <span id="scoreB">0</span>
    </div>
    <div class="scoreboard-actions">
      <button id="scoreReset" data-i18n="resetScore" data-sound="nav">–°–±—Ä–æ—Å–∏—Ç—å —Å—á—ë—Ç</button>
      <button id="replayBtn" data-i18n="replay" data-sound="nav" style="display:none;">–ü–æ–≤—Ç–æ—Ä</button>
      <button id="menuBtn" data-i18n="toMenu" data-sound="nav">–í –º–µ–Ω—é</button>
    </div>
    <div class="scoreboard-quick">
      <button id="settingsBtn" data-sound="nav" data-i18n-title="settingsTooltip" data-i18n-aria="settingsTooltip" aria-label="Open settings" title="Settings">‚öô</button>
      <button id="themeToggle" data-sound="nav" data-i18n-title="themeTooltip" data-i18n-aria="themeTooltip" aria-label="Switch theme" title="Switch theme">üåì</button>
    </div>
  </div>

  <div id="settingsModal">
    <label><span data-i18n="volume">–ì—Ä–æ–º–∫–æ—Å—Ç—å:</span> <input id="volumeSlider" type="range" min="0" max="1" step="0.01"></label>
    <label><span data-i18n="language">–Ø–∑—ã–∫:</span>
      <div id="langSelect" class="dropdown" data-value="en">
        <div class="dropdown-display"></div>
        <div class="dropdown-list">
          <div class="dropdown-option" data-value="en">English</div>
          <div class="dropdown-option" data-value="ru">–†—É—Å—Å–∫–∏–π</div>
          <div class="dropdown-option" data-value="uk">–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞</div>
        </div>
      </div>
    </label>
    <button id="settingsClose" data-i18n="close" data-sound="nav">–ó–∞–∫—Ä—ã—Ç—å</button>
  </div>

  <div id="rulesOverlay">
    <h2 data-i18n="rulesHeader">–ö–æ–Ω—Ü–µ–ø—Ü–∏—è –∏ –ø—Ä–∞–≤–∏–ª–∞ –∏–≥—Ä—ã</h2>
    <h3 data-i18n="rulesGeneral">–û–±—â–µ–µ</h3>
    <p data-i18n="rulesIntro">–≠—Ç–æ –ø–æ—à–∞–≥–æ–≤–∞—è PvP-–∞—Ä–µ–Ω–∞ 5√ó5 –¥–ª—è –¥–≤—É—Ö –∏–≥—Ä–æ–∫–æ–≤. –ò–≥—Ä–∞ –∏–¥—ë—Ç –¥–æ —Ç—Ä—ë—Ö —Ä–∞—É–Ω–¥–æ–≤ + ¬´–≤–Ω–µ–∑–∞–ø–Ω–∞—è —Å–º–µ—Ä—Ç—å¬ª (—Ü–µ–Ω—Ç—Ä 3√ó3).</p>
    <ul>
      <li data-i18n="rule1">–ö–∞–∂–¥—ã–π —Ä–∞—É–Ω–¥ –∏–≥—Ä–æ–∫–∏ –∑–∞—Ä–∞–Ω–µ–µ –≤—ã–±–∏—Ä–∞—é—Ç –ø—è—Ç—å –¥–µ–π—Å—Ç–≤–∏–π.</li>
      <li data-i18n="rule2">–î–æ—Å—Ç—É–ø–Ω—ã –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è, –æ–¥–Ω–∞ –∞—Ç–∞–∫–∞ –∏ –æ–¥–∏–Ω —â–∏—Ç –∑–∞ —Ä–∞—É–Ω–¥.</li>
      <li data-i18n="rule3">–ê—Ç–∞–∫–∞ –æ–±–æ–∑–Ω–∞—á–∞–µ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ –ø–æ—Ä–∞–∂–∞–µ—Ç —Ç–µ–∫—É—â—É—é –∏ —Å–æ—Å–µ–¥–Ω–∏–µ –∫–ª–µ—Ç–∫–∏.</li>
      <li data-i18n="rule4">–©–∏—Ç –±–ª–æ–∫–∏—Ä—É–µ—Ç –≤–µ—Å—å —É—Ä–æ–Ω –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —à–∞–≥–∞.</li>
      <li data-i18n="rule5">–ü–æ—Å–ª–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Ö–æ–¥—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ø–æ –ø–æ—Ä—è–¥–∫—É –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ —É –æ–±–æ–∏—Ö –∏–≥—Ä–æ–∫–æ–≤.</li>
      <li data-i18n="rule6">–ü–æ—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞—Å—Ç—É–ø–∞–µ—Ç –æ—Ç –ø–æ–ø–∞–¥–∞–Ω–∏—è –∞—Ç–∞–∫–∏ –∏–ª–∏ –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ –Ω–∞ –ø—Ä–æ–≤–∞–ª–∏–≤—à—É—é—Å—è –∫–ª–µ—Ç–∫—É.</li>
      <li data-i18n="rule7">–°–ø—É—Å—Ç—è —Ç—Ä–∏ —Ä–∞—É–Ω–¥–∞ –≤–Ω–µ—à–Ω–µ–µ –∫–æ–ª—å—Ü–æ –ø–æ–ª—è –æ–±—Ä—É—à–∏–≤–∞–µ—Ç—Å—è, –æ—Å—Ç–∞—ë—Ç—Å—è –∑–æ–Ω–∞ 3√ó3.</li>
      <li data-i18n="rule8">–ï—Å–ª–∏ –∏ –ø–æ—Å–ª–µ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Ä–∞—É–Ω–¥–∞ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è –Ω–µ—Ç, –∑–∞—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –Ω–∏—á—å—è.</li>
    </ul>
    <button id="rulesTutorial" data-i18n="tutorial" data-sound="nav">Tutorial</button>
    <button id="rulesClose" data-i18n="close" data-sound="nav">–ó–∞–∫—Ä—ã—Ç—å</button>
  </div>

  <div id="gameArea">
    <div id="board"></div>

    <div id="ui">
      <div id="phase"></div>
    <div id="planCells">
      <div class="planCell" id="pc0"></div>
      <div class="planCell" id="pc1"></div>
      <div class="planCell" id="pc2"></div>
      <div class="planCell" id="pc3"></div>
      <div class="planCell" id="pc4"></div>
    </div>
    <div id="actions">
      <button data-act="up" class="moveBtn" data-sound="move">‚Üë</button>
      <button data-act="down" class="moveBtn" data-sound="move">‚Üì</button>
      <button data-act="left" class="moveBtn" data-sound="move">‚Üê</button>
      <button data-act="right" class="moveBtn" data-sound="move">‚Üí</button>
      <button data-act="attack" class="atkBtn" data-sound="attack">‚öî</button>
      <button data-act="shield" class="shieldBtn" data-sound="shield">üõ°</button>
    </div>
    <div id="navButtons" style="display:flex;gap:6px;">
      <button id="btn-del" data-i18n="deleteBtn" data-sound="nav">‚Üê –£–¥–∞–ª–∏—Ç—å</button>
      <button id="btn-next" data-i18n="nextBtn" data-sound="nav">‚ñ∂ –î–∞–ª–µ–µ</button>
    </div>
  </div>
  </div>

  <div id="atkOverlay"></div>
  <div id="confirmToast"></div>
  <div id="replayOverlay">
    <button id="replayClose" data-i18n="close" data-sound="nav">Close</button>
    <button id="saveReplay" data-i18n="saveVideo" data-sound="nav" style="right:90px;top:10px;position:absolute;">Save</button>
    <button id="replayPause">‚ùö‚ùö</button>
    <div id="replayControls" class="replayControls">
      <div class="speedControl">
        <button class="speedBtn" data-speed="1">1x</button>
        <button class="speedBtn" data-speed="2">2x</button>
        <button class="speedBtn" data-speed="3">3x</button>
        <button class="speedBtn" data-speed="4">4x</button>
        <button class="speedBtn" data-speed="5">5x</button>
      </div>
      <input id="replaySeek" type="range" min="0" max="0" step="1" value="0">
    </div>
  </div>
  <div id="tutorialOverlay">
    <div id="tutorialContent"></div>
    <button id="tutorialNext" data-i18n="nextBtn" data-sound="nav">Next</button>
  </div>

  <script src="js/i18n.js"></script>
  <script src="js/dropdown.js"></script>
  <script src="js/core.js"></script>
  <script src="scripts/runtime-config.js"></script>
  <script src="js/socket.js"></script>
  <script>
    const taglines = [
      t('tagline1'),
      t('tagline2'),
      t('tagline3'),
      t('tagline4')
    ];
    const tl = document.getElementById('tagline');
    if (tl) tl.textContent = taglines[Math.floor(Math.random() * taglines.length)];
    if (window.i18n) window.i18n.applyTranslations();
  </script>

</body>
</html>
